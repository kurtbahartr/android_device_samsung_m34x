type hermesd, domain;
type hermesd_exec, exec_type, file_type, vendor_file_type;

init_daemon_domain(hermesd)

add_domain(hermesd, hal_keymint_client)
add_domain(hermesd, hal_drk_client)

add_domain(hermesd, hal_weaver_server)

allow hermesd k250a_device:chr_file rw_chr_file_perms;
allow hermesd tz_user_device:chr_file rw_chr_file_perms;
allow hermesd ssp_device:chr_file rw_chr_file_perms;
allow hermesd tee_device:chr_file rw_chr_file_perms;
allow hermesd ion_device:chr_file rw_chr_file_perms;

set_prop(hermesd, vendor_securenvm_prop)
set_prop(hermesd, vendor_securehw_prop)

allow hermesd hal_hermes_service:service_manager find;
allow hermesd hal_drk_service:service_manager find;

allow hermesd vendor_gatekeeper_data_file:dir r_dir_perms;
allow hermesd vendor_gatekeeper_data_file:file r_file_perms;

allow hermesd vendor_file:file execute_no_trans;
allow hermesd same_process_hal_file:file execute_no_trans;
